---
title: "Simulation of Pi"
output: 
    html_document:
        toc: true
        keep_md: true
        highlight: haddock
---

## Simple plot

```{r simple-plot, echo=TRUE, tidy=FALSE, fig.width=5, fig.height=5.4}
n <- 5e4 
x <- rnorm(n); y <- rnorm(n)
inside <- x^2 + y^2 <= 1
plot(x, y, col=ifelse(inside, "red", "blue"), pch=".", 
     xlim=c(-2,2), ylim=c(-2,2))
```

## Calculate Pi

```{r simulation-pi, echo=TRUE, tidy=FALSE}
n <- 1e6
x <- runif(n); y <- runif(n)
inside <- x^2 + y^2 <= 1
pi <- 4 * sum(inside) / n
idx <- sample.int(trunc(n/(log(n))), replace = FALSE)
x <- x[idx]; y <- y[idx];
inside <- inside[idx]

plot(x, y, 
     col=ifelse(inside, "blue", "red"), cex=0.5, pch=".",  
     main=sprintf("Bootstrap approximation of pi\nusing %s random samples, pi ~ %1.5f", n, pi))
```